define("modules/clean/react/previews/archive/api",["require","exports","tslib","external/lodash","modules/clean/react/previews/archive/constants","modules/clean/api_v2/client","modules/clean/filepath","modules/core/exception"],function(e,t,r,i,n,s,a,l){"use strict";function o(e){return i.keyBy(i.values(e.map(c)),"name")}function c(e){return{name:e.name,size:void 0!==e.size?parseInt(e.size,10):void 0,isDir:e.isDir,children:e.children?o(e.children):{}}}function u(e){return{rootEntry:c(e),isPasswordProtected:!!e.isEncrypted}}function p(e){return i.keyBy(e,"subpath")}function d(e){var t=a.file_extension(e);if(!n.COMPRESSED_EXTENSIONS.includes(t))return!1;var r=a.filename_without_extension(e),i=a.file_extension(r);return!n.COMPRESSED_CONTAINER_EXTENSIONS.includes(i)}function v(e){return{isDir:!0,isEncrypted:!1,children:[{isDir:!1,isEncrypted:!1,name:a.filename_without_extension(e)}],name:"/",size:"0"}}function h(e){return new Promise(function(t,r){var i=function(e){t(u(e))};if(d(e.filename)){return void i(v(e.filename))}var n=new XMLHttpRequest;n.open("GET",e.url),n.withCredentials=!0,n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE)if(200===n.status){var e=n.response,t=JSON.parse(e);i(t)}else{l.reportException({err:new Error("Failed to retrieve entry tree"),tags:["archivePreviews"],severity:l.SEVERITY.NONCRITICAL}),r("Failed to retrieve entry tree")}},n.send()})}function f(e){var t=e.rootFile,r=e.subpathInfos,i=e.user,n=e.sharedLinkUrl,a={ns_id:t.ns_id,sj_id:t.sjid,url:n},l={root_file_info:a,subpaths:r.map(function(e){return e.subpath}),subpath_sizes:r.some(function(e){return void 0===e.size})?void 0:r.map(function(e){return e.size})},o=(new s.ApiV2Client).ns("previews");return(i?o.rpc("get_archive_files",l,{subjectUserId:i.id}):o.rpc("logged_out/get_archive_files",l,{subjectUserId:null})).then(function(e){return p(e.archive_files)})}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),n=r.__importStar(n),a=r.__importStar(a),l=r.__importStar(l),t.shouldMockRootArchiveEntry=d,t.generateRootArchiveEntry=v,t.fetchRootArchiveEntry=h,t.fetchArchiveFiles=f}),define("modules/clean/react/previews/archive/app",["require","exports","tslib","react","modules/clean/previews/util","modules/clean/loggers/file_preview_logger","modules/clean/react/file_viewer/logging","modules/clean/file_store/utils","modules/clean/react/file_viewer/file_preview_event_emitter","modules/clean/react/file_viewer/constants","modules/clean/file_store/utils","modules/clean/react/file_viewer/location_utils","modules/clean/react/previews/archive/archive_entry_watcher","modules/clean/react/previews/archive/keyboard_binding_connector","modules/clean/react/previews/archive/utils","modules/clean/react/previews/archive/view","modules/clean/web_timing_logger","modules/clean/redux/types","modules/clean/file_store/utils"],function(e,t,r,i,n,s,a,l,o,c,u,p,d,v,h,f,m,_,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),l=r.__importStar(l),m=r.__importStar(m);var y=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onFetchSuccess=function(){if(t.markWebTiming(),t.logFilePreviewTimeline(c.EventType.FilePreviewDownloadSucceeded),t.logFilePreviewTimeline(c.EventType.FilePreviewRenderSucceeded),t.props.entry){var e=h.scanEntryContents(t.props.entry);t.logArchivePreviewEvent(c.EventType.ArchivePreviewContentsScanned,e)}t.props.setRenderStatusSuccess()},t.onFetchFailure=function(){t.logFilePreviewTimeline(c.EventType.FilePreviewDownloadFailed),t.props.onError&&t.props.onError()},t.handleEntryRowClick=function(e,r){e.preventDefault();var i=t.props.fileSubpath,n=p.addToFileSubpath(i,r.name);p.updateFileSubpathQuery(n),t.logUserAction(r,c.UserAction.ArchiveNavigation,c.UserActionContext.PreviewContentMain)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.setUpLogger(),this.fetchArchiveContents()},t.prototype.componentWillUnmount=function(){this.teardownLogger(),this.props.resetState(),p.updateFileSubpathQuery(null)},t.prototype.componentDidUpdate=function(e){if(w.areFilesEqual(e.file,this.props.file)&&e.file.preview_url===this.props.file.preview_url||(this.props.resetState(),this.fetchArchiveContents()),e.treeApiStatus===_.ApiClientStatus.Fetch)switch(this.props.treeApiStatus){case _.ApiClientStatus.Success:this.onFetchSuccess();break;case _.ApiClientStatus.Error:this.onFetchFailure()}},t.prototype.fetchArchiveContents=function(){if(this.logFilePreviewTimeline(c.EventType.FilePreviewSupportConfirmed),!this.props.file.preview_url)return void(this.props.onError&&this.props.onError());this.logFilePreviewTimeline(c.EventType.FilePreviewDownloadAttempted);var e=h.getPreviewUrl(this.props.file.preview_url),t=l.getFilename(this.props.file);this.props.fetchRootArchiveEntry({url:e,filename:t})},t.prototype.setUpLogger=function(){this.logger&&this.teardownLogger(),this.logger=new s.FilePreviewArchiveLogger,this.logger.listenTo(o.filePreviewEventEmitter)},t.prototype.teardownLogger=function(){this.logger.unlistenTo(o.filePreviewEventEmitter),delete this.logger},t.prototype.logFilePreviewTimeline=function(e){this.props.filePreviewSession&&this.props.filePreviewSession.recordEvent(e)},t.prototype.logArchivePreviewEvent=function(e,t){void 0===t&&(t={}),o.filePreviewEventEmitter.emit(e,this.props.filePreviewSession,t)},t.prototype.logUserAction=function(e,t,r){a.logUserAction(t,r,{isDir:e.isDir,extension:e.isDir?"":n.getWhitelistedExtension(e.name)})},t.prototype.markWebTiming=function(){this.props.filePreviewSession&&this.props.filePreviewSession.markPrimaryEvent(),m.mark_time_to_view(),m.mark_time_to_interactive()},t.prototype.render=function(){return i.default.createElement("div",null,i.default.createElement(f.View,{entry:this.props.entry,fileExtension:u.getExtension(this.props.file),isPasswordProtected:this.props.isPasswordProtected,onEntryRowClick:this.handleEntryRowClick,rootFile:this.props.file}),i.default.createElement(d.ArchiveEntryWatcher,{file:this.props.file,fileSubpath:this.props.fileSubpath,sharedLinkUrl:this.props.sharedLinkUrl,user:this.props.user}),i.default.createElement(v.ArchiveKeyboardBindingConnector,{fileSubpath:this.props.fileSubpath}))},t})(i.default.Component);t.App=y}),define("modules/clean/react/previews/archive/archive_entry_watcher",["require","exports","tslib","react","external/react-redux","modules/clean/react/previews/archive/data/actions","modules/clean/react/previews/archive/data/selectors","modules/clean/react/previews/archive/utils"],function(e,t,r,i,n,s,a,l){"use strict";function o(e,t){var r=t.file,i=t.fileSubpath,n=u(e,{fileSubpath:i,rootFile:r});return{neededSubpathInfos:l.getNeededArchiveFileSubpathInfos(i,n).filter(function(t){return a.getShouldFetchArchiveFiles(e,{subpath:t.subpath})})}}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i);var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fetchArchiveFiles=function(e){var r=t.props;(0,r.fetchArchiveFiles)({rootFile:r.file,subpathInfos:e,sharedLinkUrl:r.sharedLinkUrl,user:r.user})},t}return r.__extends(t,e),t.prototype.componentDidUpdate=function(){var e=this.props.neededSubpathInfos;e.length&&this.fetchArchiveFiles(e)},t.prototype.render=function(){return null},t})(i.default.Component);t.UnconnectedArchiveEntryWatcher=c;var u=a.makeGetArchiveEntry(),p={fetchArchiveFiles:s.fetchArchiveFiles};t.ArchiveEntryWatcher=n.connect(o,p)(c)}),define("modules/clean/react/previews/archive/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_NUM_ROWS=10,t.MAX_ROW_WIDTH_IN_EMS=17,t.COMPRESSED_EXTENSIONS=["bz","bz2","gz","lz","lzma","xz","z"],t.COMPRESSED_CONTAINER_EXTENSIONS=["tar","xar"]}),define("modules/clean/react/previews/archive/data/actions",["require","exports","tslib","external/lodash","modules/clean/react/previews/archive/api","modules/clean/previews/data/actions"],function(e,t,r,i,n,s){"use strict";function a(){return{type:f.GetTreeApiFetch}}function l(e){var t=e.entry,r=e.isPasswordProtected;return{type:f.GetTreeApiSuccess,payload:{entry:t,isPasswordProtected:r}}}function o(e){return{type:f.GetTreeApiError,payload:{error:e}}}function c(e){var t=e.subpaths;return{type:f.GetArchiveFilesApiFetch,meta:{subpaths:t}}}function u(e){return{type:f.GetArchiveFilesApiSuccess,payload:{archiveFiles:e}}}function p(e,t){var r=t.subpaths;return{type:f.GetArchiveFilesApiError,meta:{subpaths:r},error:e}}function d(){return{type:f.ResetState}}function v(e){return function(t){t(a()),n.fetchRootArchiveEntry(e).then(function(e){t(l({entry:e.rootEntry,isPasswordProtected:e.isPasswordProtected}))}).catch(function(e){t(o(e))})}}function h(e){var t=e.rootFile,r=e.sharedLinkUrl,a=e.subpathInfos,l=e.user,o=a.map(function(e){return e.subpath});return function(e){return e(c({subpaths:o})),n.fetchArchiveFiles({rootFile:t,sharedLinkUrl:r,subpathInfos:a,user:l}).then(function(r){return e(u(r)),e(s.populateArchivePreviews(t,i.values(r))),r}).catch(function(t){return e(p(t,{subpaths:o})),t})}}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n);var f;(function(e){e.ResetState="ArchivePreviewResetState",e.GetTreeApiFetch="ArchivePreviewGetTreeApiFetch",e.GetTreeApiSuccess="ArchivePreviewGetTreeApiSuccess",e.GetTreeApiError="ArchivePreviewGetTreeApiError",e.GetArchiveFilesApiFetch="ArchivePreviewGetArchiveFilesApiFetch",e.GetArchiveFilesApiSuccess="ArchivePreviewGetArchiveFilesApiSuccess",e.GetArchiveFilesApiError="ArchivePreviewGetArchiveFilesApiError"})(f=t.Actions||(t.Actions={})),t.getTreeApiFetch=a,t.getTreeApiSuccess=l,t.getTreeApiError=o,t.getArchiveFilesApiFetch=c,t.getArchiveFilesApiSuccess=u,t.getArchiveFilesApiError=p,t.resetState=d,t.fetchRootArchiveEntry=v,t.fetchArchiveFiles=h}),define("modules/clean/react/previews/archive/data/reducer",["require","exports","tslib","modules/clean/react/previews/archive/data/actions","modules/clean/redux/types","external/lodash"],function(e,t,r,i,n,s){"use strict";function a(e,a){switch(void 0===e&&(e=t.initialState),a.type){case i.Actions.GetTreeApiFetch:return r.__assign({},e,{treeApiStatus:n.ApiClientStatus.Fetch});case i.Actions.GetTreeApiSuccess:return r.__assign({},e,{rootEntry:a.payload.entry,isPasswordProtected:a.payload.isPasswordProtected,treeApiStatus:n.ApiClientStatus.Success});case i.Actions.GetTreeApiError:return r.__assign({},e,{treeApiStatus:n.ApiClientStatus.Error,error:a.payload.error});case i.Actions.GetArchiveFilesApiFetch:return r.__assign({},e,{archiveFiles:r.__assign({},e.archiveFiles,a.meta.subpaths.reduce(function(e,t){return e[t]={archiveFile:void 0,apiStatus:n.ApiClientStatus.Fetch},e},{}))});case i.Actions.GetArchiveFilesApiSuccess:return r.__assign({},e,{archiveFiles:r.__assign({},e.archiveFiles,s.mapValues(a.payload.archiveFiles,function(e){return{archiveFile:e,apiStatus:n.ApiClientStatus.Success}}))});case i.Actions.GetArchiveFilesApiError:return r.__assign({},e,{archiveFiles:r.__assign({},a.meta.subpaths.reduce(function(e,t){return e[t]={archiveFile:void 0,apiStatus:n.ApiClientStatus.Error,error:a.error},e},{}))});case i.Actions.ResetState:return t.initialState;default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importStar(s),t.initialState={archiveFiles:{},rootEntry:void 0,treeApiStatus:void 0,error:void 0},t.previewArchiveReducer=a}),define("modules/clean/react/previews/archive/data/selectors",["require","exports","tslib","external/lodash","external/reselect","modules/clean/react/previews/archive/data/utils","modules/clean/redux/types","modules/clean/redux/selectors"],function(e,t,r,i,n,s,a,l){"use strict";function o(e){return e[a.PREVIEW_ARCHIVE_NAMESPACE_KEY]}function c(e,t,r){var i=r.fileSubpath,n=r.rootFile;if(!e)return e;var a=i?s.walkEntryTree(e,i):e;return s.getEntryWithArchiveFiles({subpath:i,rootFile:n,entry:a,archiveFilesMap:t})}function u(){return n.createSelector([v,h,l.getOptions],c)}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),t.getEncryptedStatus=function(e){return o(e).isPasswordProtected};var p=function(e,t){var r=o(e).archiveFiles;if(r)return r[t]},d=function(e,t){var r=t.subpath,i=p(e,r);if(i)return i.apiStatus},v=i.flow(o,i.property("rootEntry")),h=i.flow(o,function(e){return i.get(e,"archiveFiles",{})});t.makeGetArchiveEntry=u,t.getShouldFetchArchiveFiles=function(e,t){var r=t.subpath;if(!r)return!1;var i=d(e,{subpath:r});return!i||![a.ApiClientStatus.Fetch,a.ApiClientStatus.Error].includes(i)},t.isErrorStateForSubpath=function(e,t){var r=t.subpath;return!!r&&d(e,{subpath:r})===a.ApiClientStatus.Error},t.getTreeApiStatus=function(e){return o(e).treeApiStatus}}),define("modules/clean/react/previews/archive/data/store",["require","exports","modules/clean/react/previews/archive/data/reducer","modules/clean/redux/types","modules/clean/redux/store"],function(e,t,r,i,n){"use strict";function s(){return a||(a=n.getStoreAndRegisterReducers((e={},e[i.PREVIEW_ARCHIVE_NAMESPACE_KEY]=r.previewArchiveReducer,e))),a;var e}Object.defineProperty(t,"__esModule",{value:!0});var a;t.getStoreForPreviewArchive=s}),define("modules/clean/react/previews/archive/data/utils",["require","exports","tslib","external/lodash","modules/clean/react/file_viewer/location_utils","modules/clean/react/previews/archive/utils"],function(e,t,r,i,n,s){"use strict";function a(e,t){for(var r=t.substring(1).split("/"),i=e,s="";r.length;){var a=r.shift(),l=a?i.children[a]:void 0;if(!l)return s!==t&&n.updateFileSubpathQuery(s),i;i=l,s+="/"+a}return i}function l(e){var t=e.subpath,i=e.entry,n=e.rootFile,a=e.archiveFilesMap;if(i.isDir||!t)return i;var l=a[t]&&a[t].archiveFile;return r.__assign({},i,{file:s.createFileFromEntryAndApi(i,n,l)})}function o(e){var t=e.subpath,s=e.entry,a=e.rootFile,o=e.archiveFilesMap,c=i.mapValues(s.children,function(e,r){return l({subpath:n.addToFileSubpath(t,r),entry:e,rootFile:a,archiveFilesMap:o})});return r.__assign({},s,{children:c})}function c(e){return e.entry.isDir?o(e):l(e)}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),t.walkEntryTree=a,t.getEntryWithArchiveFiles=c}),define("modules/clean/react/previews/archive/entry_row",["require","exports","tslib","react","spectrum/file_icon","spectrum/icon_content","spectrum/media_table","modules/clean/display_format","modules/clean/em_string","modules/clean/react/previews/archive/constants","modules/clean/react/previews/archive/utils","modules/clean/react/thumbnail"],function(e,t,r,i,n,s,a,l,o,c,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i);var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){e.stopPropagation(),t.props.onClick&&t.props.onClick(e,t.props.entry)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,r=t.entry,n=t.shouldHideSize,s=t.topOffset;return this.props.onClick?i.default.createElement(a.CulledMediaRow,{topOffset:s,onClick:this.handleClick,doubleLine:!0},function(t){return v({entry:r,highlight:t.isHovered,onClick:e.handleClick,shouldHideSize:n})}):i.default.createElement(a.CulledMediaRow,{topOffset:s,doubleLine:!0},v({entry:r,shouldHideSize:n}))},t})(i.default.Component);t.EntryRow=d;var v=function(e){var t=e.entry,r=e.onClick,n=e.highlight,s=e.shouldHideSize,u=o.Emstring.em_snippet(t.name,c.MAX_ROW_WIDTH_IN_EMS),p=[i.default.createElement(a.MediaCell,{key:"rowname",title:r?i.default.createElement("button",{className:"entry-row-button",onClick:r,"aria-label":t.name},u):u,icon:i.default.createElement(h,{displayName:t.name,file:t.file,isDir:t.isDir}),highlight:n})];return t.size&&!s&&p.push(i.default.createElement(a.MediaCell,{key:"rowsize",title:l.format_bytes(t.size)})),p},h=function(e){return e.isDir?i.default.createElement(s.IconContent,{name:"folder-small"}):e.file&&u.shouldAllowVisualFolderIcons()?i.default.createElement(p.ThumbnailIcon,{className:"entry-row-icon",file:e.file,alt:e.displayName}):i.default.createElement(n.FileIcon,{path:e.displayName})}}),define("modules/clean/react/previews/archive/file_entry_view",["require","exports","tslib","react","external/classnames","modules/clean/react/file_viewer/data/selectors","modules/clean/redux/types","modules/clean/react/previews/loading_indicator","modules/clean/react/file_viewer/file_preview","modules/clean/react/file_viewer/constants","modules/clean/react/size_class/size_class","modules/clean/react/previews/constants","modules/clean/previews/constants","external/react-redux","modules/clean/react/previews/archive/data/selectors","modules/clean/react/previews/archive/utils","modules/clean/react/size_class/constants","modules/clean/previews/data/selectors"],function(e,t,r,i,n,s,a,l,o,c,u,p,d,v,h,f,m,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),n=r.__importDefault(n),t.PreviewTypeWhitelist=[d.PreviewType.Doc,d.PreviewType.Excel,d.PreviewType.HTML,d.PreviewType.Photo,d.PreviewType.Text],t._FileEntryView=function(e){var r=e.entry,n=e.previewApiData,s=e.isErrorState,l=e.isFullscreen,u=e.isSidebarOpen,d=e.sizeClass,v=e.rootFile,h=r.file,_=d!==m.SizeClass.Small,w={canCopyToDropboxRoles:[],canDownloadRoles:[],canPrintRoles:[],canRemoveLinkUids:[],canSyncToDropboxRoles:[],canViewContextMenuRoles:[],canViewMetadataRoles:[]};return h?i.default.createElement(o.FilePreviewWithLogging,{file:h,isFullscreen:l,isSidebarOpen:u,sourceAction:p.PreviewSourceAction.Click,sourceContext:p.PreviewSourceContext.ArchiveFile,maxFilenameEmLength:c.SizeClassFilenameLengthMap[d],previewTypeWhitelist:t.PreviewTypeWhitelist,sharePermission:w,shouldDisplayToolbar:_,previewApiData:n,sizeClass:d}):s?i.default.createElement(o.FilePreview,{file:f.createFileFromEntry(r,v),previewApiData:{data:void 0,status:a.ApiClientStatus.Error},isFullscreen:l,isSidebarOpen:u,sourceAction:p.PreviewSourceAction.Click,sourceContext:p.PreviewSourceContext.ArchiveFile,maxFilenameEmLength:c.SizeClassFilenameLengthMap[d],previewTypeWhitelist:t.PreviewTypeWhitelist,sharePermission:w,shouldDisplayToolbar:_,sizeClass:d}):i.default.createElement(y,null)};var w=u.withSizeClass(t._FileEntryView,{responsiveClassName:"preview-content--full-height"});t.FileEntryView=v.connect(function(e,t){return{previewApiData:_.getPreviewForArchiveFile(e,t.entry.file),isFullscreen:s.getIsFullScreen(e),isSidebarOpen:s.getIsSidebarOpen(e),isErrorState:h.isErrorStateForSubpath(e,{subpath:t.currentSubpath})}})(w);var y=function(){return i.default.createElement("div",{className:n.default("preview-content","preview-content--center","preview-content--full-height")},i.default.createElement(l.LoadingIndicator,null))}}),define("modules/clean/react/previews/archive/folder_entry_view",["require","exports","tslib","react","external/classnames","external/lodash","spectrum/icon_content","spectrum/dimensions","spectrum/table","modules/clean/react/previews/archive/entry_row","modules/clean/react/size_class/size_class","modules/clean/react/size_class/constants","modules/core/i18n"],function(e,t,r,i,n,s,a,l,o,c,u,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),n=r.__importDefault(n),s=r.__importStar(s),t.FolderEntryView=function(e){var t=e.entry,r=e.onEntryRowClick,n=e.shouldAllowFileNavigation,a=s.values(t.children);return a.length?i.default.createElement(h,{entries:a,onRowClick:r,shouldAllowFileNavigation:n}):i.default.createElement(f,null)};var v=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderEntryRow=function(e,r,n){var s=t.props.shouldAllowFileNavigation||e.isDir?t.props.onRowClick:void 0;return i.default.createElement(c.EntryRow,{entry:e,onClick:s,shouldHideSize:t.props.sizeClass===p.SizeClass.Small,topOffset:n})},t}return r.__extends(t,e),t.prototype.render=function(){var e=this;return i.default.createElement(l.Dimensions,{className:"preview-archive__table"},function(t){var r=(t.width,t.height);return i.default.createElement(o.Table,null,i.default.createElement(o.FixedTableHead,null,i.default.createElement(o.TableHeadCell,null,d._("Name")),e.props.sizeClass===p.SizeClass.Small?null:i.default.createElement(o.TableHeadCell,null,d._("Size"))),i.default.createElement(o.CulledTableBody,{items:e.props.entries,listItemHeight:72,renderRow:e.renderEntryRow,viewportHeight:r,shouldUseWindowAsScrollContainer:!1}))})},t})(i.default.Component),h=u.withSizeClass(v,{responsiveClassName:"preview-content--full-height"}),f=function(){return i.default.createElement("div",{className:n.default("preview-content","preview-content--center","preview-content--column","preview-content--full-height","preview-archive--empty")},i.default.createElement(a.IconContent,{name:"folder-small"}),i.default.createElement("div",{className:"empty-text u-pad-top-s"},d._("This folder is empty")))}}),define("modules/clean/react/previews/archive/keyboard_binding_connector",["require","exports","tslib","react","modules/clean/keycode","modules/clean/react/file_viewer/location_utils","modules/clean/react/keyboard_binding/keyboard_binding","modules/clean/react/keyboard_binding/keyboard_binding_connector"],function(e,t,r,i,n,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i);var o=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleKeyPress=function(e){var r=s.shortenFileSubpathBy(t.props.fileSubpath,1);return s.updateFileSubpathQuery(r),!0},t.keyboardBindings=[{keyboardEventCriteria:a.generateUnmodifiedKeyboardEventCriteria(n.KeyCode.ESC),callback:t.handleKeyPress}],t}return r.__extends(t,e),t.prototype.render=function(){return i.default.createElement(l.KeyboardBindingConnector,{keyboardBindings:this.keyboardBindings})},t})(i.default.Component);t.ArchiveKeyboardBindingConnector=o}),define("modules/clean/react/previews/archive/preview_archive",["require","exports","tslib","react","external/react-redux","modules/clean/react/previews/archive/app","modules/clean/react/previews/archive/data/selectors","modules/clean/react/previews/archive/data/store","modules/clean/react/previews/archive/data/actions","modules/clean/react/css"],function(e,t,r,i,n,s,a,l,o,c){"use strict";function u(e,t){return{entry:p(e,{fileSubpath:t.fileSubpath,rootFile:t.file}),isPasswordProtected:a.getEncryptedStatus(e),treeApiStatus:a.getTreeApiStatus(e)}}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i);var p=a.makeGetArchiveEntry(),d={fetchRootArchiveEntry:o.fetchRootArchiveEntry,resetState:o.resetState},v=n.connect(u,d)(s.App);t.PreviewArchiveForTesting=v;var h=l.getStoreForPreviewArchive(),f=function(e){return i.default.createElement(n.Provider,{store:h},i.default.createElement(v,r.__assign({},e)))},m=c.requireCssWithComponent(f,["/static/css/preview_archive-vfl0t4JZm.css"]);t.PreviewArchive=m}),define("modules/clean/react/previews/archive/utils",["require","exports","tslib","external/lodash","modules/clean/react/file_viewer/location_utils","modules/clean/previews/util","modules/core/uri"],function(e,t,r,i,n,s,a){"use strict";function l(e){var t=a.URI.parse(e.toString()),r=t.toString();return"//"===r.slice(0,2)&&(r="https:"+r),r}function o(e){for(var t={},r=[e];r.length;){var n=r.shift();if(n.isDir)r.push.apply(r,i.values(n.children));else{var a=s.getWhitelistedExtension(n.name);t[a]=++t[a]||1}}return t}function c(e,t){return{subpath:e.name,is_dir:!1,filename:e.name,ns_id:t.ns_id,sjid:t.sjid,bytes:e.size,beacon_context:void 0,preview_type:null,sort_key:void 0,href:void 0,ts:void 0,file_id:void 0,revision_id:void 0,is_symlink:!1}}function u(e,t,r){if(r)return{beacon_context:void 0,bytes:e.size,direct_blockserver_link:r.direct_blockserver_link,file_id:void 0,filename:r.filename,href:void 0,htmlified_link:r.htmlified_link,is_dir:!1,ns_id:t.ns_id,preview_ssr_image_url_tmpl:r.preview_ssr_image_url_tmpl,preview_ssr_refresh_url:r.preview_ssr_refresh_url,preview_ssr_text_url_tmpl:r.preview_ssr_text_url_tmpl,preview_thumbnail_url:r.preview_thumbnail_url,preview_type:r.preview_type?r.preview_type:null,preview_url:r.preview_url,revision_id:void 0,sjid:t.sjid,sort_key:void 0,subpath:r.subpath,thumbnail_url_tmpl:r.thumbnail_url_tmpl,ts:void 0,is_symlink:!1,preview:r.preview}}function p(e,t){return t?t.isDir||t.file||!e?i.values(t.children).filter(function(e){return!e.isDir&&!e.file}).map(function(t){return{subpath:n.addToFileSubpath(e,t.name),size:t.size}}):[{subpath:e,size:t.size}]:[]}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),t.getPreviewUrl=l,t.shouldAllowVisualFolderIcons=function(){return!1},t.scanEntryContents=o,t.createFileFromEntry=c,t.createFileFromEntryAndApi=u,t.getNeededArchiveFileSubpathInfos=p}),define("modules/clean/react/previews/archive/view",["require","exports","tslib","react","spectrum/media_table_skeleton","spectrum/snackbar","modules/clean/react/async/loadable","modules/clean/react/previews/archive/folder_entry_view","modules/clean/react/previews/archive/constants","modules/core/i18n"],function(e,t,r,i,n,s,a,l,o,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i);var u=a.Loadable({loader:function(){return new Promise(function(t,r){e(["modules/clean/react/previews/archive/file_entry_view"],t,r)}).then(r.__importStar).then(function(e){return e.FileEntryView})}});t.View=function(e){var t=e.entry,r=e.rootFile,n=e.fileExtension,a=e.isPasswordProtected,l=e.onEntryRowClick;return i.default.createElement("div",{className:"preview-archive"},i.default.createElement("div",{className:"preview-archive__content"},t?i.default.createElement(p,{entry:t,rootFile:r,shouldAllowFileNavigation:!a,onEntryRowClick:l}):i.default.createElement(d,null),a?i.default.createElement(s.Snackbar,{title:c._("Can’t preview items in password-protected %(extension)s files.",{comment:"Like 'Can’t preview items in password-protected .zip files.'"}).format({extension:"."+n}),variant:"warn"}):null))};var p=function(e){return e.entry.isDir?i.default.createElement(l.FolderEntryView,{entry:e.entry,onEntryRowClick:e.onEntryRowClick,shouldAllowFileNavigation:e.shouldAllowFileNavigation}):i.default.createElement(u,{entry:e.entry,rootFile:e.rootFile})},d=function(){return i.default.createElement("div",{className:"preview-archive__table"},i.default.createElement(n.MediaTableSkeleton,{numRows:o.DEFAULT_NUM_ROWS}))}});
//# sourceMappingURL=pkg-file_viewer_archive.min.js-vfldjNEt7.map